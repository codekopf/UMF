<main role="main" class="container">

  <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
    <h1 class="h2">Issues</h1>
    <div class="btn-toolbar mb-2 mb-md-0">
      <div class="btn-group">
        <button type="button" class="btn btn-sm btn-secondary" (click)="getAllIssues()">All issues</button>
        <button type="button" class="btn btn-sm btn-primary" (click)="getAllPumpAndDumpIssues()">Pump & Dump</button>
        <button type="button" class="btn btn-sm btn-warning" (click)="getAllSpoofingIssues()">Spoofing</button>
        <button type="button" class="btn btn-sm btn-success" (click)="getAllLayeringIssues()">Layering</button>
        <button type="button" class="btn btn-sm btn-info" (click)="getAllOtherOrderBaseIssues()">Other order based</button>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col-12 table-responsive">
      <p-table
        [value]="issueShortInfoList"
        [ngClass]="['table', 'table-bordered', 'table-striped']"
        [style]="{'width':'100%','overflow':'auto!important'}"
        [responsive]="true"
      >
        <ng-template pTemplate="header">
          <tr>
            <th>Created Date</th>
            <th>Issue Type</th>
            <th>Trader Names</th>
            <th>Instrument</th>
          </tr>
        </ng-template>

        <ng-template pTemplate="body" let-rowData>
          <tr ng-repeat="rowData in let-rowData" ng-click="showClient(rowData)">

            <td><a [routerLink]="['/issues/', rowData.id]"><small class="text-muted">{{ rowData.createdDate }}</small></a></td>
            <td>
              <button type="button" [ngClass]="['btn', 'btn-sm', 'btn-block', assignBootstrapButtonClassForIssue(rowData.issueType)]">{{ rowData.issueType | issueTypePipe }}</button>
            </td>
            <td>{{rowData.traderNames}}</td>
            <td>{{rowData.instrument}}</td>
          </tr>
        </ng-template>
      </p-table>
    </div>
  </div>

  <div class="row">
    <ng-container *ngFor="let issueShortInfo of issueShortInfoList; index as i">

      <div class="col-sm-3">
        <div class="card mb-3 shadow-sm">
          <a [routerLink]="['/issues/', issueShortInfo.id]">
            <div class="card-body">
              <div class="d-flex justify-content-between align-items-center">
                <div class="btn-group">
                  <button type="button" [ngClass]="['btn', 'btn-sm', 'btn-block', assignBootstrapButtonClassForIssue(issueShortInfo.issueType)]">{{ issueShortInfo.issueType | issueTypePipe }}</button>
                </div>
                <small class="text-muted">{{ issueShortInfo.createdDate }}</small>
              </div>
              <p class="card-text mb-auto mt-2" *ngIf="showInstrument(issueShortInfo)">{{ issueShortInfo.instrument }}</p>
              <p class="card-text mb-auto mt-2" *ngIf="showTraders(issueShortInfo)">{{ issueShortInfo | showTradersPipe }}</p>
            </div>
          </a>
        </div>
      </div>
    </ng-container>
  </div>

  <div class="row">
    <div class="col-6 col-sm-4">
      <div ngbDropdown class="d-inline-block" id="recordsPerPageMenu">
        <button class="btn btn-outline-primary btn-sm" id="recordsPerPageButton" ngbDropdownToggle>{{selectedRecordsPerPage}}</button>
        <div ngbDropdownMenu aria-labelledby="recordsPerPageButton">
          <button class="dropdown-item" *ngFor="let recordsPerPage of recordsPerPageList" (click)="changeRecordsPerPage(recordsPerPage)" >{{recordsPerPage}}</button>
        </div>
      </div>
    </div>
    <div class="col-6 col-sm-8">
      <app-pagination [totalPages]="pages" [pageCurrent]="page" (pageSelected)="onPageSelected($event)"></app-pagination>
    </div>
  </div>

</main>
